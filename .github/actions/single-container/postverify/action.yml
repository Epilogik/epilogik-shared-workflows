name: Deploy - Post Verify
description: Run simple post-deployment checks on the remote container
inputs:
  container_name:
    description: 'Container name'
    required: true
  ssh_host:
    description: 'SSH host'
    required: true
  ssh_user:
    description: 'SSH user'
    required: true
  ssh_port:
    description: 'SSH port'
    required: false
    default: '22'
runs:
  using: 'composite'
  steps:
    - name: Post-deployment verification
      shell: bash
      run: |
        set -euo pipefail
        ssh -p ${{ inputs.ssh_port }} ${{ inputs.ssh_user }}@${{ inputs.ssh_host }} 'bash -s' <<'REMOTE'
          echo "ðŸ“Š Container status:"
          docker ps --filter "name=${{ inputs.container_name }}" --format "table {{.Names}}\t{{.Status}}\t{{.Ports}}"
          echo "ðŸ’¾ Container resource usage:"
          docker stats --no-stream --format "table {{.Container}}\t{{.CPUPerc}}\t{{.MemUsage}}\t{{.NetIO}}" ${{ inputs.container_name }} || true
        REMOTE
